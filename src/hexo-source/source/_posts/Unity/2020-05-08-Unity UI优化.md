---
title: "Unity UI ä¼˜åŒ–å®Œå…¨æ‰‹å†Œï¼šNGUI ä¸ UGUI çš„æ€§èƒ½æå‡ä¹‹é“"
date: 2020/05/08
categories: [æŠ€æœ¯æ–‡ç« , Unityå¼€å‘]
tags: [Unity, UIä¼˜åŒ–, NGUI, UGUI, æ€§èƒ½ä¼˜åŒ–, DrawCall, OverDraw, HUDä¼˜åŒ–]
image: /images/unity-ui-optimization-banner.jpg
---

# ğŸ¨ Unity UI ä¼˜åŒ–å®Œå…¨æ‰‹å†Œï¼šNGUI ä¸ UGUI çš„æ€§èƒ½æå‡ä¹‹é“

> ğŸ’¡ **UI ä¼˜åŒ–çš„ä»·å€¼**ï¼š
> - UI å¯¼è‡´ DrawCall çˆ†ç‚¸ï¼Œå¸§ç‡æš´è·Œï¼Ÿ
> - Canvas åˆ·æ–°é¢‘ç‡è¿‡é«˜ï¼ŒCPU å‹åŠ›å·¨å¤§ï¼Ÿ
> - è¡€æ¡ã€é£˜å­—ç­‰ HUD å…ƒç´ å¤ªå¤šï¼Œæ€§èƒ½æ‰›ä¸ä½ï¼Ÿ
> - NGUI å’Œ UGUI ä¼˜åŒ–æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ
>
> **è¿™ç¯‡æ–‡ç« ï¼** å°†ç³»ç»Ÿè®²è§£ Unity UI ä¼˜åŒ–æŠ€æœ¯ï¼Œä»æ¸²æŸ“å¼€é”€åˆ°æ›´æ–°é¢‘ç‡ï¼Œä» NGUI åˆ° UGUIï¼Œè®© UI æ€§èƒ½ç¿»å€ï¼

---

## ä¸€ã€UI ä¼˜åŒ–æ¦‚è§ˆ

### 1.1 ä¸‰å¤§ä¼˜åŒ–ç›®æ ‡

```
UI ä¼˜åŒ–ä¸‰å¤§æ”¯æŸ±:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ é™ä½æ¸²æŸ“å¼€é”€ â”‚  â”‚ é™ä½æ›´æ–°å¼€é”€ â”‚  â”‚
â”‚  â”‚  DrawCall   â”‚  â”‚ ç½‘æ ¼é‡å»º     â”‚  â”‚
â”‚  â”‚  OverDraw   â”‚  â”‚ Layout Rebuildâ”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ é«˜æ•ˆå¤„ç†HUD â”‚                    â”‚
â”‚  â”‚  è¡€æ¡/é£˜å­—  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| ç›®æ ‡ | å…³é”®æŒ‡æ ‡ | å½±å“ |
|-----|---------|------|
| **é™ä½æ¸²æŸ“å¼€é”€** | DrawCall æ•°é‡ã€OverDraw | GPU æ€§èƒ½ |
| **é™ä½æ›´æ–°å¼€é”€** | ç½‘æ ¼é‡å»ºé¢‘ç‡ã€Layout Rebuild | CPU æ€§èƒ½ |
| **é«˜æ•ˆå¤„ç† HUD** | è¡€æ¡/é£˜å­—æ•°é‡ã€æ›´æ–°é¢‘ç‡ | æ•´ä½“æ€§èƒ½ |

### 1.2 NGUI vs UGUI å¯¹æ¯”

| ç‰¹æ€§ | NGUI | UGUI |
|-----|------|------|
| **å…ƒç´ æ›´æ–°æ–¹å¼** | SetActive è§¦å‘é‡å»º | RectTransform å˜æ›´è§¦å‘ |
| **éšè—æ–¹å¼** | Alpha=0ã€Scale=0 | CanvasGroup.alpha |
| **DrawCall åˆå¹¶** | UIPanel ä¸ºå•ä½ | Canvas ä¸ºå•ä½ |
| **ç½‘æ ¼æ›´æ–°** | LateUpdate ä¸­æ›´æ–° | Job System å¤šçº¿ç¨‹ |
| **æ£€æµ‹å·¥å…·** | DrawCall Tool | Frame Debugger |

---

## äºŒã€é™ä½æ¸²æŸ“å¼€é”€

### 2.1 DrawCall ä¼˜åŒ–

| æ£€æŸ¥é¡¹ | å»ºè®®å€¼ | è¯´æ˜ |
|-------|--------|------|
| **æ­£å¸¸ç•Œé¢** | <30 DC | å¸¸è§„åŠŸèƒ½ç•Œé¢ |
| **å¤æ‚ç•Œé¢** | <50 DC | å«å¤§é‡åŠ¨ç”»/ç‰¹æ•ˆ |
| **æ£€æµ‹å·¥å…·** | Frame Debugger | åˆ†æåˆæ‰¹æƒ…å†µ |

#### UGUI DrawCall è§„åˆ™

```
UGUI åˆæ‰¹æ¡ä»¶:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¿…é¡»åŒæ—¶æ»¡è¶³:                       â”‚
â”‚                                     â”‚
â”‚  1. ç›¸åŒ Canvas                      â”‚
â”‚  2. ç›¸åŒå›¾é›† (Texture)               â”‚
â”‚  3. ç›¸åŒæè´¨ (Material)              â”‚
â”‚  4. å±‚çº§é¡ºåºä¸€è‡´ (æ— ç©¿æ’)            â”‚
â”‚  5. æ— é‡å  (æˆ–å¯å¿½ç•¥é‡å )            â”‚
â”‚  6. Z å€¼ä¸€è‡´ (é€šå¸¸ä¸º 0)              â”‚
â”‚                                     â”‚
â”‚  æ‰“ç ´ä»»ä¸€æ¡ä»¶ â†’ äº§ç”Ÿæ–° DrawCall      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### DrawCall ä¸Šå‡åŸå› 

| åŸå›  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|-----|------|---------|
| **å±‚çº§ç©¿æ’** | ScrollView ä¸çº¢ç‚¹ç­‰ç©¿æ’ | è°ƒæ•´å±‚çº§é¡ºåº |
| **Z å€¼ä¸ä¸º 0** | ä¸å…¶ä»– UI ä¸åŒ | ç»Ÿä¸€ Z=0 |
| **åŠ¨æ€é®æŒ¡** | è¿è¡Œæ—¶é‡å æ£€æµ‹ | é¿å…åŠ¨æ€é®æŒ¡ |
| **ä¸åŒå›¾é›†** | Tag ç›¸åŒä½†æ‰“åŒ…ä¸åŒ | æ£€æŸ¥ Sprite Packer |

### 2.2 OverDraw ä¼˜åŒ–

| æ€§èƒ½å‚æ•° | å®šä¹‰ | å»ºè®®å€¼ |
|---------|------|--------|
| **æ€»å¡«å……æ•°å€¼å³°** | å•å¸§æ€»å¡«å……åƒç´ æ•°é‡æœ€å¤§å€¼ | è¶Šä½è¶Šå¥½ |
| **å¡«å……å€æ•°å³°å€¼** | å•å¸§æœ€å¤§å¡«å……å€æ•° | <3x |
| **å•å¸§å¡«å……å€æ•°** | æ€»å¡«å……æ•° / åˆ†è¾¨ç‡ | <2x |

#### ç»˜åˆ¶é¡ºåºä¼˜åŒ–

| é˜Ÿåˆ— | ç»˜åˆ¶é¡ºåº | é€‚ç”¨å¯¹è±¡ | ä¼˜åŒ–æ•ˆæœ |
|-----|---------|---------|---------|
| **Geometry** | ä»å‰å‘å | ä¸é€æ˜ UI | åˆ©ç”¨ Early-Z |
| **Transparent** | ä»åå‘å‰ | åŠé€æ˜ UI | æ­£ç¡®æ··åˆ |
| **Overlay** | ä»åå‘å‰ | è¦†ç›–å±‚ UI | æ­£ç¡®æ˜¾ç¤º |

> ğŸ’¡ **æç¤º**ï¼šç§»åŠ¨ç«¯å°½é‡ä½¿ç”¨ Geometry é˜Ÿåˆ—å®ç°ä»å‰å‘åç»˜åˆ¶ï¼

#### OverDraw ä¼˜åŒ–ç­–ç•¥

| ç­–ç•¥ | è¯´æ˜ |
|-----|------|
| **æ§åˆ¶ç»˜åˆ¶é¡ºåº** | ä»å‰å‘åç»˜åˆ¶ï¼Œåˆ©ç”¨ Early-Z |
| **å‡å°é‡å åŒºåŸŸ** | å‡å°‘ä¸å¿…è¦çš„é‡å  |
| **é•‚ç©ºç»˜åˆ¶** | åªç»˜åˆ¶å¯è§åŒºåŸŸ (PolygonImage) |
| **ç®€åŒ– UI è®¾è®¡** | å‡å°‘è£…é¥°æ€§é‡å å…ƒç´  |

---

## ä¸‰ã€é™ä½æ›´æ–°å¼€é”€

### 3.1 ç½‘æ ¼æ›´æ–°æœºåˆ¶

```
UGUI ç½‘æ ¼æ›´æ–°æµç¨‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Canvas.Send  â”‚â”€â”€>â”‚WaitingForJobâ”‚â”€â”€>â”‚PutGeometry  â”‚
â”‚MessageInG   â”‚    â”‚JobGroup     â”‚    â”‚JobFence    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚BatchRendererâ”‚
                                    â”‚   Flush     â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ€§èƒ½åˆ†æå‡½æ•°

| å‡½æ•° | è¯´æ˜ | é—®é¢˜å®šä½ |
|-----|------|---------|
| **Canvas.BuildBatch** | åˆå¹¶ Canvas ä¸‹æ‰€æœ‰ UI å…ƒç´ ç½‘æ ¼ | æ£€æŸ¥åˆæ‰¹å¼€é”€ |
| **Canvas.SendWillRenderCanvases** | é€šçŸ¥é‡å»º Layout æˆ– Graphic | æ£€æŸ¥é‡å»ºé¢‘ç‡ |
| **WaitingForJobGroup** | ç­‰å¾…å­çº¿ç¨‹ç½‘æ ¼åˆå¹¶ | ç½‘æ ¼å¼€é”€å·¨å¤§ |
| **PutGeometryJobFence** | ç½‘æ ¼åˆå¹¶åŒæ­¥ç‚¹ | å¤šçº¿ç¨‹ç­‰å¾… |

### 3.3 è§¦å‘é‡å»ºçš„æ“ä½œ

| æ“ä½œ | NGUI | UGUI |
|-----|------|------|
| **éšè—å…ƒç´ ** | `SetActive(false)` è§¦å‘ | `SetActive(false)` è§¦å‘ |
| **æ›¿ä»£æ–¹æ¡ˆ** | `Alpha=0`ã€`Scale=0` | `CanvasGroup.alpha=0` |
| **ä½ç½®å˜æ›´** | å¯èƒ½è§¦å‘é‡å»º | `RectTransform` å˜æ›´è§¦å‘ |

### 3.4 åŠ¨é™åˆ†ç¦»

```
Canvas åˆ†ç¦»ç­–ç•¥:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸» Canvas (é™æ€)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ èƒŒæ™¯    â”‚  â”‚ å›ºå®šè£…é¥° â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                     â”‚
â”‚  åŠ¨æ€ Canvas (é¢‘ç¹æ›´æ–°)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ è¡€æ¡    â”‚  â”‚ å€’è®¡æ—¶   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                     â”‚
â”‚  ç‰¹æ•ˆ Canvas (ç²’å­/ç‰¹æ•ˆ)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ ç²’å­    â”‚  â”‚ ä¼¤å®³é£˜å­— â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5 é™ä½æ›´æ–°é¢‘ç‡

```csharp
// âœ… é™ä½å°åœ°å›¾æ›´æ–°é¢‘ç‡
public class MinimapUpdater : MonoBehaviour
{
    public float updateInterval = 0.5f;  // 0.5ç§’æ›´æ–°ä¸€æ¬¡
    private float timer;

    void Update()
    {
        timer += Time.deltaTime;
        if (timer >= updateInterval)
        {
            UpdateMinimap();
            timer = 0;
        }
    }

    void UpdateMinimap()
    {
        // æ›´æ–°å°åœ°å›¾é€»è¾‘
    }
}
```

### 3.6 é¿å…"æ•æ„Ÿæ“ä½œ"

| æ“ä½œ | é—®é¢˜ | ä¼˜åŒ–æ–¹æ¡ˆ |
|-----|------|---------|
| é¢‘ç¹ SetActive | è§¦å‘å…¨é‡é‡å»º | ä½¿ç”¨ Alpha/Scale |
| è¿ç»­ Position èµ‹å€¼ | å¯èƒ½æ— å˜åŒ– | æ£€æŸ¥å˜åŒ–å†èµ‹å€¼ |
| åŠ¨æ€æ·»åŠ /åˆ é™¤å…ƒç´  | ç ´ååˆæ‰¹ | ä½¿ç”¨å¯¹è±¡æ±  |

```csharp
// âŒ æ¯å¸§èµ‹å€¼å¯èƒ½è§¦å‘é‡å»º
void Update()
{
    rectTransform.position = targetPosition;
}

// âœ… æ£€æŸ¥å˜åŒ–å†èµ‹å€¼
private Vector3 lastPosition;
void Update()
{
    if (targetPosition != lastPosition)
    {
        rectTransform.position = targetPosition;
        lastPosition = targetPosition;
    }
}
```

---

## å››ã€HUD å…ƒç´ ä¼˜åŒ–

### 4.1 è¡€æ¡ä¼˜åŒ–

| ç­–ç•¥ | è¯´æ˜ |
|-----|------|
| **ä½¿ç”¨ Simple/Filled æ¨¡å¼** | å‡å°‘é¡¶ç‚¹æ•° |
| **ç›¸åŒå›¾é›†** | ç¡®ä¿ DrawCall åˆå¹¶ |
| **åˆ†å¸§åŠ è½½** | é¿å…å•å¸§åˆ›å»ºè¿‡å¤š |
| **World Space Canvas** | é¿å…ä¸»è§’ç§»åŠ¨è§¦å‘é‡å»º |

```csharp
// âœ… ä½¿ç”¨ World Space Canvas é¿å…é‡å»º
// å°†ä¸»è§’è¡€æ¡æ”¾åœ¨å•ç‹¬çš„ World Space Canvas
// é¿å…ä¸»è§’ç§»åŠ¨è§¦å‘å…¶ä»– UI é‡å»º

Canvas hpCanvas = Instantiate(hpCanvasPrefab);
hpCanvas.renderMode = RenderMode.WorldSpace;
hpCanvas.worldCamera = uiCamera;
```

### 4.2 ä¼¤å®³é£˜å­—ä¼˜åŒ–

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|-----|---------|
| é¢‘ç¹åˆ›å»ºé”€æ¯ | ä½¿ç”¨å¯¹è±¡æ±  |
| æ¯å¸§æ›´æ–°ä½ç½® | éš”å¸§æ›´æ–° |
| æ•°é‡çˆ†ç‚¸ | æ§åˆ¶åŒå±æ€»é‡ |
| æ–‡å­—è½¬å›¾ç‰‡ | ä½¿ç”¨å›¾ç‰‡å­—ä½“ |

```csharp
// âœ… é£˜å­—å¯¹è±¡æ± 
public class DamageTextPool : MonoBehaviour
{
    private Queue<DamageText> pool = new Queue<DamageText>();
    public int maxCount = 20;

    public DamageText Get()
    {
        if (pool.Count > 0)
            return pool.Dequeue();
        return CreateNew();
    }

    public void Return(DamageText text)
    {
        if (pool.Count < maxCount)
            pool.Enqueue(text);
        else
            Destroy(text.gameObject);
    }

    private DamageText CreateNew()
    {
        return Instantiate(damageTextPrefab).GetComponent<DamageText>();
    }
}
```

### 4.3 HUD ä¼˜åŒ–æ€»ç»“

| ä¼˜åŒ–é¡¹ | NGUI | UGUI |
|-------|------|------|
| **è¡€æ¡æ¨¡å¼** | Simple/Filled | Filled |
| **å›¾é›†** | ç›¸åŒå›¾é›† | ç›¸åŒ Sprite Atlas |
| **åˆ†å¸§åŠ è½½** | å¿…éœ€ | å¿…éœ€ |
| **ä¸»è§’åˆ†ç¦»** | World Space UIPanel | World Space Canvas |
| **é£˜å­—æ± ** | å¯¹è±¡æ±  | å¯¹è±¡æ±  |
| **ä½ç½®æ›´æ–°** | éš”å¸§æ›´æ–° | éš”å¸§æ›´æ–° |
| **å­—ä½“** | å›¾ç‰‡å­— | TextMeshPro |

---

## äº”ã€é’ˆå¯¹æ€§ä¼˜åŒ–

### 5.1 æ–‡å­—ä¼˜åŒ–

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|-----|------|---------|
| **Outline å¼€é”€å¤§** | å¤åˆ¶ 4 ä»½æ–‡å­— Mesh | ä½¿ç”¨ Shadow æ›¿ä»£ |
| **Shadow æ€§èƒ½** | æ·»åŠ é¡¶ç‚¹å®ç°é˜´å½± | ä½¿ç”¨ TextMeshPro |

```csharp
// âœ… TextMeshPro ä¼˜åŠ¿
// - æ›´å°‘çš„é¡¶ç‚¹æ•°
// - æ›´å¥½çš„å­—ä½“æ¸²æŸ“
// - æ”¯æŒä¸°å¯Œçš„æ–‡å­—æ•ˆæœ
// - æ›´å¥½çš„æ€§èƒ½

// æ›¿æ¢ Text ç»„ä»¶ä¸º TextMeshPro
```

### 5.2 Mask ç»„ä»¶ä¼˜åŒ–

| ç»„ä»¶ | DrawCall å¼€é”€ | OverDraw | æ›¿ä»£æ–¹æ¡ˆ |
|-----|--------------|----------|---------|
| **Mask** | +4 DC | æœ‰ | RectMask2D |
| **RectMask2D** | +0 DC | æ—  | ä»…çŸ©å½¢åŒºåŸŸ |
| **MeshMask** | +1 DC | æ—  | è‡ªå®šä¹‰å½¢çŠ¶ |

### 5.3 Image ç»„ä»¶ä¼˜åŒ–

| è®¾ç½® | æ•ˆæœ |
|-----|------|
| **å–æ¶ˆ Fill Center** | ä¹å®«æ ¼ä¸­å¿ƒé•‚ç©º |
| **ç¦ç”¨ Raycast Target** | ä¸éœ€è¦äº¤äº’çš„å…ƒç´  |
| **é¿å… Tiled ç±»å‹** | å‡å°‘çº¹ç†é‡‡æ · |
| **é¿å… Pixel Perfect** | å‡å°‘è®¡ç®—å¼€é”€ |

### 5.4 ç©º Image å¤„ç†

```csharp
// âŒ ç©º Image ä»ä¼šæ¸²æŸ“
<Image raycastTarget="true" />

// âœ… è‡ªå®šä¹‰ç©º Graphic
public class EmptyGraphic : Graphic
{
    protected override void OnPopulateMesh(VertexHelper vh)
    {
        // ä¸ç”Ÿæˆä»»ä½•é¡¶ç‚¹
    }
}
```

### 5.5 é¢œè‰²åŠ¨ç”»ä¼˜åŒ–

```csharp
// âŒ ä¿®æ”¹ Image.color ä¼šè§¦å‘ç½‘æ ¼é‡å»º
private Image image;
void Update()
{
    image.color = targetColor;  // æ¯å¸§é‡å»ºç½‘æ ¼
}

// âœ… ä½¿ç”¨ç‹¬ç«‹ Material é¿å…é‡å»º
private Material material;
void LateUpdate()
{
    material.color = targetColor;  // åªæ›´æ–°æè´¨å±æ€§
}
```

---

## å…­ã€ä¼˜åŒ–æŠ€å·§æ±‡æ€»

### 6.1 ç¦ç”¨ç»„ä»¶æ¸…å•

| ç»„ä»¶/åŠŸèƒ½ | åŸå›  | æ›¿ä»£æ–¹æ¡ˆ |
|---------|------|---------|
| **UI/Effect/Shadow** | 4 ä»½ Mesh é¡¶ç‚¹ | TextMeshPro |
| **UI/Effect/Outline** | ç»§æ‰¿ Shadow æ›´å¼€é”€ | TextMeshPro SDF |
| **Image.Tiled** | é«˜é‡‡æ ·å¼€é”€ | è‡ªå®šä¹‰ Shader |
| **Pixel Perfect** | é¢å¤–è®¡ç®— | æ‰‹åŠ¨å¸ƒå±€ |
| **Text.BestFit** | é¢„ç”Ÿæˆæ‰€æœ‰å­—å· | å›ºå®šå­—å· |

### 6.2 æ£€æµ‹é‡å å…³ç³»

```
çº¿æ¡†æ¨¡å¼æ£€æµ‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frame Debug â†’ Toggle Wireframe     â”‚
â”‚                                     â”‚
â”‚  ç”¨é€”:                               â”‚
â”‚  â€¢ æ£€æŸ¥ UI é‡å å…³ç³»                 â”‚
â”‚  â€¢ åˆ†æç©¿æ’é—®é¢˜                     â”‚
â”‚  â€¢ éªŒè¯å±‚çº§é¡ºåº                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 æ–‡å­—åˆ†å±‚ç­–ç•¥

| åŸåˆ™ | è¯´æ˜ |
|-----|------|
| **æ–‡å­—é¡¶å±‚** | æ‰€æœ‰æ–‡å­—æ”¾åœ¨æ¸²æŸ“æœ€é¡¶å±‚ |
| **å›¾ç‰‡åº•å±‚** | å›¾ç‰‡æ”¾åœ¨æ–‡å­—ä¸‹æ–¹ |
| **æ‹“æ‰‘æ’åº** | ä¿æŒä¸€è‡´çš„å±‚çº§é¡ºåº |

### 6.4 å¤šè¾¹å½¢é•‚ç©º

```csharp
// å¤šè¾¹å½¢é•‚ç©ºè„šæœ¬
// åªæ˜¾ç¤ºå¯è§åŒºåŸŸï¼Œå‡å°‘ OverDraw
// å‚è€ƒ: https://blog.uwa4d.com/archives/fillrate.html

public class PolygonImage : Image
{
    protected override void OnPopulateMesh(VertexHelper vh)
    {
        base.OnPopulateMesh(vh);
        // è‡ªå®šä¹‰å¤šè¾¹å½¢é•‚ç©ºé€»è¾‘
    }
}
```

### 6.5 äº‹ä»¶æ‹¦æˆªä¼˜åŒ–

```csharp
// âŒ æ‰€æœ‰ Graphic éƒ½å‚ä¸ Raycast
// æ€§èƒ½å¼€é”€å¤§

// âœ… ç¦ç”¨ä¸éœ€è¦çš„ Raycast Target
Image image = GetComponent<Image>();
image.raycastTarget = false;  // çº¯å±•ç¤ºå…ƒç´ 
```

---

## ä¸ƒã€ä¼˜åŒ–æ£€æŸ¥æ¸…å•

### 7.1 å¿«é€Ÿæ£€æŸ¥

| æ£€æŸ¥é¡¹ | NGUI | UGUI |
|-------|------|------|
| **DrawCall æ•°é‡** | <50 | <30 |
| **ç½‘æ ¼é‡å»ºé¢‘ç‡** | æ£€æŸ¥ FillAll è°ƒç”¨ | æ£€æŸ¥ BuildBatch |
| **OverDraw** | <2x å¹³å‡ | <2x å¹³å‡ |
| **åŠ¨é™åˆ†ç¦»** | âœ… | âœ… |
| **å¯¹è±¡æ± ** | âœ… | âœ… |

### 7.2 æ€§èƒ½å»ºè®®

| åœºæ™¯ | DrawCall ç›®æ ‡ |
|-----|--------------|
| **PC é¡¹ç›®** | <100 |
| **æ‰‹æ¸¸é«˜ç«¯** | <50 |
| **æ‰‹æ¸¸ä½ç«¯** | <30 |

### 7.3 ç»¼åˆæ¸…å•

- [ ] DrawCall æ•°é‡è¾¾æ ‡
- [ ] ç½‘æ ¼é‡å»ºé¢‘ç‡åˆç†
- [ ] OverDraw åœ¨ç›®æ ‡èŒƒå›´å†…
- [ ] åŠ¨é™åˆ†ç¦»å®Œæˆ
- [ ] å¯¹è±¡æ± å·²å®ç°
- [ ] ç¦ç”¨ Raycast Target (ä¸éœ€è¦äº¤äº’çš„)
- [ ] é¿å… Outline/Shadow
- [ ] é¿å… BestFit
- [ ] é¿å… Pixel Perfect
- [ ] é¿å… Tiled Image
- [ ] ä½¿ç”¨ RectMask2D æ›¿ä»£ Mask
- [ ] HUD ä½¿ç”¨ World Space
- [ ] é£˜å­—ä½¿ç”¨å¯¹è±¡æ± 
- [ ] æ–‡å­—åˆ†å±‚æ­£ç¡®
- [ ] å›¾é›†è§„åˆ’åˆç†

---

## å…«ã€å‚è€ƒèµ„æ–™

- [UWA - UI ä¼˜åŒ–ç›´æ’­è§†é¢‘](https://blog.uwa4d.com/archives/video_UI.html)
- [UWA - NGUI ä¼˜åŒ–è¯¦è§£](https://blog.uwa4d.com/archives/USparkle_NGUI.html)
- [Unity - UI Optimization](https://docs.unity3d.com/Manual/MobileOptimizationPracticalScriptingOptimizations.html)
- [UWA - å¡«å……ç‡ä¼˜åŒ–](https://blog.uwa4d.com/archives/fillrate.html)

---

**è½¬è½½è¯·æ³¨æ˜æ¥æº**ï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 1487842110@qq.com
