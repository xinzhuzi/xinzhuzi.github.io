---
title: "Unity MenuItem å®Œå…¨æŒ‡å—ï¼šæ‰“é€ é«˜æ•ˆç¼–è¾‘å™¨èœå•ç³»ç»Ÿ"
date: 2020/05/08
categories: [æŠ€æœ¯æ–‡ç« , Unityå¼€å‘]
tags: [Unity, UnityEditor, MenuItem, ç¼–è¾‘å™¨æ‰©å±•, èœå•å¼€å‘, å¿«æ·é”®]
image: /images/unity-menuitem-banner.jpg
---

# ğŸ“‹ Unity MenuItem å®Œå…¨æŒ‡å—ï¼šæ‰“é€ é«˜æ•ˆç¼–è¾‘å™¨èœå•ç³»ç»Ÿ

> ğŸ’¡ **èœå•ç³»ç»Ÿçš„åŠ›é‡**ï¼š
> - æƒ³ä¸ºå›¢é˜Ÿæ‰“é€ ç»Ÿä¸€çš„å·¥å…·èœå•å…¥å£ï¼Ÿ
> - å¿«æ·é”®æ€ä¹ˆè®¾ç½®ï¼Œå“ªäº›ç¬¦å·ä»£è¡¨ä»€ä¹ˆæŒ‰é”®ï¼Ÿ
> - å¦‚ä½•å®ç°èœå•é¡¹çš„åŠ¨æ€å¯ç”¨/ç¦ç”¨ï¼Ÿ
> - æ€æ ·åœ¨å³é”®èœå•ä¸­æ·»åŠ è‡ªå®šä¹‰é€‰é¡¹ï¼Ÿ
>
> **è¿™ç¯‡æ–‡ç« ï¼** å°†ç³»ç»Ÿè®²è§£ MenuItem çš„æ‰€æœ‰é«˜çº§ç”¨æ³•ï¼Œå¸®ä½ æ‰“é€ ä¸“ä¸šçº§çš„ç¼–è¾‘å™¨èœå•ç³»ç»Ÿï¼

## ä¸€ã€MenuItem æ¦‚è¿°

`MenuItem` ç‰¹æ€§ç”¨äºåœ¨ Unity ç¼–è¾‘å™¨èœå•æ æˆ–ä¸Šä¸‹æ–‡èœå•ä¸­æ·»åŠ è‡ªå®šä¹‰èœå•é¡¹ã€‚

### 1.1 èœå•ä½ç½®

| èœå•ä½ç½® | è¯´æ˜ | ç¤ºä¾‹è·¯å¾„ |
|---------|------|---------|
| **é¡¶éƒ¨èœå•** | ç¼–è¾‘å™¨é¡¶éƒ¨èœå•æ  | `Tools/MyTool` |
| **ä¸Šä¸‹æ–‡èœå•** | å³é”®èœå• | `CONTEXT/Component/MyAction` |
| **èµ„æºèœå•** | Project çª—å£å³é”® | `Assets/MyAction` |
| **å±‚çº§èœå•** | Hierarchy çª—å£å³é”® | `GameObject/MyAction` |

---

## äºŒã€åŸºæœ¬ç”¨æ³•

### 2.1 åˆ›å»ºé¡¶éƒ¨èœå•é¡¹

```csharp
using UnityEngine;
using UnityEditor;

public class MenuItemExample : Editor
{
    // åœ¨ Tools èœå•ä¸‹æ·»åŠ èœå•é¡¹
    [MenuItem("Tools/My Custom Tool")]
    static void MyCustomTool()
    {
        Debug.Log("æ‰§è¡Œè‡ªå®šä¹‰å·¥å…·");
    }

    // åˆ›å»ºå­èœå•
    [MenuItem("Tools/MyMenu/Option 1")]
    static void Option1()
    {
        Debug.Log("é€‰é¡¹1");
    }

    [MenuItem("Tools/MyMenu/Option 2")]
    static void Option2()
    {
        Debug.Log("é€‰é¡¹2");
    }
}
```

### 2.2 èœå•ç»“æ„

```
Unity ç¼–è¾‘å™¨èœå•æ 
â”œâ”€â”€ File
â”œâ”€â”€ Edit
â”œâ”€â”€ Assets
â”œâ”€â”€ GameObject
â”œâ”€â”€ Components
â”œâ”€â”€ Window
â””â”€â”€ Tools
    â”œâ”€â”€ My Custom Tool      â† è‡ªå®šä¹‰èœå•é¡¹
    â””â”€â”€ MyMenu              â† è‡ªå®šä¹‰å­èœå•
        â”œâ”€â”€ Option 1
        â””â”€â”€ Option 2
```

---

## ä¸‰ã€èœå•ä¼˜å…ˆçº§

ä½¿ç”¨ `priority` å‚æ•°æ§åˆ¶èœå•é¡¹çš„æ˜¾ç¤ºé¡ºåºï¼Œæ•°å€¼è¶Šå°è¶Šé å‰ã€‚

### 3.1 ä¼˜å…ˆçº§è§„åˆ™

| ä¼˜å…ˆçº§èŒƒå›´ | è¯´æ˜ | ç¤ºä¾‹åˆ†ç»„ |
|-----------|------|---------|
| 0 - 49 | æ”¾åœ¨æœ€å‰é¢ï¼Œä¸å†…ç½®èœå•åˆ†å¼€ | è‡ªå®šä¹‰å·¥å…·ç»„ |
| 50 - 1000 | æŒ‰ 50 çš„å€æ•°åˆ†ç»„ | 10ã€100ã€150 ç­‰ |
| 10 | å‚è€ƒåˆ†ç»„ | å¸¸ç”¨å·¥å…· |
| 100 | å‚è€ƒåˆ†ç»„ | ä¸€èˆ¬å·¥å…· |

### 3.2 ç¤ºä¾‹ä»£ç 

```csharp
public class MenuItemPriority : Editor
{
    [MenuItem("Tools/Priority Test/A (ä¼˜å…ˆçº§5)", false, 5)]
    static void TestA() => Debug.Log("A");

    [MenuItem("Tools/Priority Test/B (ä¼˜å…ˆçº§15)", false, 15)]
    static void TestB() => Debug.Log("B");

    [MenuItem("Tools/Priority Test/C (ä¼˜å…ˆçº§25)", false, 25)]
    static void TestC() => Debug.Log("C");

    [MenuItem("Tools/Priority Test/D (ä¼˜å…ˆçº§100)", false, 100)]
    static void TestD() => Debug.Log("D");

    [MenuItem("Tools/Priority Test/E (ä¼˜å…ˆçº§200)", false, 200)]
    static void TestE() => Debug.Log("E");
}
```

### 3.3 æ˜¾ç¤ºæ•ˆæœ

```
Tools èœå•
â”œâ”€â”€ Priority Test
â”‚   â”œâ”€â”€ A (ä¼˜å…ˆçº§5)       â† æœ€é å‰
â”‚   â”œâ”€â”€ B (ä¼˜å…ˆçº§15)
â”‚   â”œâ”€â”€ C (ä¼˜å…ˆçº§25)
â”‚   â”œâ”€â”€ ------------------- â† 50å€æ•°åˆ†éš”çº¿
â”‚   â”œâ”€â”€ D (ä¼˜å…ˆçº§100)
â”‚   â””â”€â”€ E (ä¼˜å…ˆçº§200)     â† æœ€å
â””â”€â”€ (å…¶ä»–èœå•é¡¹)
```

---

## å››ã€èœå•éªŒè¯

é€šè¿‡éªŒè¯å‡½æ•°æ§åˆ¶èœå•é¡¹çš„å¯ç”¨/ç¦ç”¨çŠ¶æ€ã€‚

### 4.1 åŸºæœ¬è¯­æ³•

```csharp
[MenuItem("èœå•è·¯å¾„", éªŒè¯å‡½æ•°å)]
static void èœå•æ–¹æ³•() { }

static bool éªŒè¯å‡½æ•°å()
{
    // è¿”å› trueï¼šèœå•é¡¹å¯ç”¨
    // è¿”å› falseï¼šèœå•é¡¹ç¦ç”¨ï¼ˆç°è‰²æ˜¾ç¤ºï¼‰
    return true;
}
```

### 4.2 éªŒè¯ç¤ºä¾‹

```csharp
public class MenuItemValidation : Editor
{
    // æ™®é€šèœå•é¡¹
    [MenuItem("Tools/Create Cube", false, 10)]
    static void CreateCube()
    {
        GameObject.CreatePrimitive(PrimitiveType.Cube);
    }

    // å¸¦éªŒè¯çš„èœå•é¡¹
    [MenuItem("Tools/Create Cube", true, 11)]
    static bool ValidateCreateCube()
    {
        // åªåœ¨é€‰ä¸­ç‰©ä½“æ—¶å¯ç”¨
        return Selection.activeGameObject != null;
    }

    // æ›´å¤æ‚çš„éªŒè¯
    [MenuItem("Tools/Rename Selection", false, 20)]
    static void RenameSelection()
    {
        Selection.activeObject.name = "RenamedObject";
    }

    [MenuItem("Tools/Rename Selection", true, 20)]
    static bool ValidateRenameSelection()
    {
        // å¿…é¡»é€‰ä¸­å•ä¸ªç‰©ä½“
        return Selection.activeGameObject != null &&
               Selection.gameObjects.Length == 1;
    }

    // é’ˆå¯¹ç‰¹å®šç±»å‹çš„éªŒè¯
    [MenuItem("Tools/Add Rigidbody", true, 30)]
    static bool ValidateAddRigidbody()
    {
        // é€‰ä¸­ç‰©ä½“å¿…é¡»æ²¡æœ‰ Rigidbody ç»„ä»¶
        if (Selection.activeGameObject)
        {
            return Selection.activeGameObject.GetComponent<Rigidbody>() == null;
        }
        return false;
    }
}
```

### 4.3 éªŒè¯å‡½æ•°è¿”å›å€¼æ•ˆæœ

| è¿”å›å€¼ | èœå•çŠ¶æ€ |
|-------|---------|
| `true` | æ­£å¸¸æ˜¾ç¤ºï¼Œå¯ç‚¹å‡» |
| `false` | ç°è‰²æ˜¾ç¤ºï¼Œç¦ç”¨ç‚¹å‡» |

---

## äº”ã€èœå•å‹¾é€‰çŠ¶æ€

ä¸ºèœå•é¡¹æ·»åŠ å‹¾é€‰æ ‡è®°ï¼ˆå¯¹å·ï¼‰ã€‚

### 5.1 åŸºæœ¬ç”¨æ³•

```csharp
public class MenuItemChecked : Editor
{
    [MenuItem("Tools/Toggle Feature  %#g")]
    static void ToggleFeature()
    {
        string menuPath = "Tools/Toggle Feature";
        bool currentState = Menu.GetChecked(menuPath);
        Menu.SetChecked(menuPath, !currentState);

        Debug.Log($"åŠŸèƒ½å·²{(!currentState ? "å¯ç”¨" : "ç¦ç”¨")}");
    }
}
```

### 5.2 å¿«æ·é”®è¯´æ˜

`%#g` è¡¨ç¤ºå¿«æ·é”® `Ctrl+G`ï¼ˆmacOS ä¸º `Cmd+G`ï¼‰

| ç¬¦å· | è¯´æ˜ |
|------|------|
| `%` | Ctrl / Cmd |
| `#` | Shift |
| `&` | Alt |
| `_` | æ— ä¿®é¥°é”® |

### 5.3 å¸¸ç”¨å¿«æ·é”®ç»„åˆ

```csharp
[MenuItem("Tools/Quick Action  %g")]   // Ctrl+G
[MenuItem("Tools/Quick Action  %#g")]  // Ctrl+Shift+G
[MenuItem("Tools/Quick Action  &g")]   // Alt+G
[MenuItem("Tools/Quick Action  _g")]   // G
```

### 5.4 åˆ‡æ¢åŠŸèƒ½ç¤ºä¾‹

```csharp
public class EditorSettingsToggle : Editor
{
    private const string DEBUG_MODE_PATH = "Tools/Debug Mode";

    [MenuItem(DEBUG_MODE_PATH)]
    static void ToggleDebugMode()
    {
        bool currentState = Menu.GetChecked(DEBUG_MODE_PATH);
        Menu.SetChecked(DEBUG_MODE_PATH, !currentState);

        // ä¿å­˜è®¾ç½®
        EditorPrefs.SetBool("DebugMode_Enabled", !currentState);
    }

    // å¯åŠ¨æ—¶åŒæ­¥å‹¾é€‰çŠ¶æ€
    [MenuItem("Tools/Sync Debug Mode", false, 100)]
    static void SyncDebugMode()
    {
        bool enabled = EditorPrefs.GetBool("DebugMode_Enabled", false);
        Menu.SetChecked(DEBUG_MODE_PATH, enabled);
    }
}
```

---

## å…­ã€ä¸Šä¸‹æ–‡èœå•

ä¸ºç‰¹å®šç»„ä»¶æˆ–èµ„æºæ·»åŠ å³é”®èœå•ã€‚

### 6.1 ç»„ä»¶ä¸Šä¸‹æ–‡èœå•

```csharp
public class ComponentContextMenu
{
    // Transform ç»„ä»¶çš„å³é”®èœå•
    [MenuItem("CONTEXT/Transform/Reset to Zero")]
    static void ResetTransform(MenuCommand command)
    {
        Transform transform = command.context as Transform;
        if (transform != null)
        {
            Undo.RecordObject(transform, "Reset Transform");
            transform.localPosition = Vector3.zero;
            transform.localRotation = Quaternion.identity;
            transform.localScale = Vector3.one;
        }
    }

    // éªŒè¯ï¼šåªå¯¹ Transform ç»„ä»¶æœ‰æ•ˆ
    [MenuItem("CONTEXT/Transform/Reset to Zero", true)]
    static bool ValidateResetTransform()
    {
        return Selection.activeTransform != null;
    }

    // Rigidbody ç»„ä»¶çš„å³é”®èœå•
    [MenuItem("CONTEXT/Rigidbody/Set Mass to 1")]
    static void SetRigidbodyMass(MenuCommand command)
    {
        Rigidbody rb = command.context as Rigidbody;
        if (rb != null)
        {
            Undo.RecordObject(rb, "Set Mass");
            rb.mass = 1f;
        }
    }

    // é€šç”¨ç»„ä»¶å³é”®èœå•ï¼ˆé€‚ç”¨äºæ‰€æœ‰ç»„ä»¶ï¼‰
    [MenuItem("CONTEXT/Component/Copy Component Name")]
    static void CopyComponentName(MenuCommand command)
    {
        Component component = command.context as Component;
        if (component != null)
        {
            GUIUtility.systemCopyBuffer = component.GetType().Name;
            Debug.Log($"å·²å¤åˆ¶: {component.GetType().Name}");
        }
    }
}
```

### 6.2 èµ„æºä¸Šä¸‹æ–‡èœå•

```csharp
public class AssetContextMenu
{
    // Project çª—å£å³é”®èœå•
    [MenuItem("Assets/Select Dependencies")]
    static void SelectDependencies()
    {
        string path = AssetDatabase.GetAssetPath(Selection.activeObject);
        string[] dependencies = AssetDatabase.GetDependencies(path, true);

        List<Object> dependencyObjects = new List<Object>();
        foreach (string dep in dependencies)
        {
            Object obj = AssetDatabase.LoadMainAssetAtPath(dep);
            if (obj != null)
                dependencyObjects.Add(obj);
        }

        Selection.objects = dependencyObjects.ToArray();
    }

    [MenuItem("Assets/Select Dependencies", true)]
    static bool ValidateSelectDependencies()
    {
        return Selection.activeObject != null;
    }
}
```

### 6.3 GameObject ä¸Šä¸‹æ–‡èœå•

```csharp
public class GameObjectContextMenu
{
    // Hierarchy çª—å£å³é”®èœå•
    [MenuItem("GameObject/Custom/Group Under Empty", false, 0)]
    static void GroupUnderEmpty()
    {
        GameObject[] selected = Selection.gameObjects;
        if (selected.Length == 0)
            return;

        GameObject parent = new GameObject("Group");
        Undo.RegisterCreatedObjectUndo(parent, "Create Group");

        Vector3 center = Vector3.zero;
        foreach (GameObject obj in selected)
        {
            center += obj.transform.position;
        }
        center /= selected.Length;

        parent.transform.position = center;

        foreach (GameObject obj in selected)
        {
            Undo.SetTransformParent(obj.transform, parent.transform, "Group Objects");
        }
    }

    [MenuItem("GameObject/Custom/Group Under Empty", true)]
    static bool ValidateGroupUnderEmpty()
    {
        return Selection.gameObjects.Length > 0;
    }
}
```

---

## ä¸ƒã€MenuCommand å‚æ•°

`MenuCommand` å‚æ•°æä¾›äº†ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚

### 7.1 MenuCommand å±æ€§

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `context` | Object | è¢«å³é”®ç‚¹å‡»çš„å¯¹è±¡ |
| `userData` | object | ç”¨æˆ·æ•°æ® |

### 7.2 ä½¿ç”¨ç¤ºä¾‹

```csharp
public class MenuCommandExample
{
    [MenuItem("CONTEXT/Transform/Log Info")]
    static void LogTransformInfo(MenuCommand command)
    {
        Transform transform = command.context as Transform;
        if (transform != null)
        {
            Debug.Log($"Transform åç§°: {transform.name}");
            Debug.Log($"ä½ç½®: {transform.position}");
            Debug.Log$"å±‚çº§: {transform.hierarchyCount}");
        }
    }

    [MenuItem("CONTEXT/Component/Show Type")]
    static void ShowComponentType(MenuCommand command)
    {
        Component component = command.context as Component;
        if (component != null)
        {
            Debug.Log($"ç»„ä»¶ç±»å‹: {component.GetType().FullName}");
            Debug.Log($"æ‰€åœ¨çš„ GameObject: {component.gameObject.name}");
        }
    }
}
```

---

## å…«ã€å®Œæ•´ç¤ºä¾‹ï¼šæ‰¹é‡æ“ä½œå·¥å…·

```csharp
using UnityEngine;
using UnityEditor;

public class BatchOperations
{
    // æ‰¹é‡é‡å‘½åé€‰ä¸­çš„ç‰©ä½“
    [MenuItem("Tools/Batch/Rename Selected")]
    static void BatchRenameSelected()
    {
        string prefix = "Object_";
        int startNumber = 1;

        GameObject[] selected = Selection.gameObjects;
        if (selected.Length == 0)
        {
            EditorUtility.DisplayDialog("æç¤º", "è¯·å…ˆé€‰ä¸­ GameObject", "ç¡®å®š");
            return;
        }

        Undo.RecordObjects(selected, "Batch Rename");

        for (int i = 0; i < selected.Length; i++)
        {
            selected[i].name = $"{prefix}{startNumber + i}";
        }

        Debug.Log($"å·²é‡å‘½å {selected.Length} ä¸ªç‰©ä½“");
    }

    [MenuItem("Tools/Batch/Rename Selected", true)]
    static bool ValidateBatchRenameSelected()
    {
        return Selection.gameObjects.Length > 0;
    }

    // æ‰¹é‡æ·»åŠ ç»„ä»¶
    [MenuItem("Tools/Batch/Add Rigidbody to Selection")]
    static void BatchAddRigidbody()
    {
        GameObject[] selected = Selection.gameObjects;
        if (selected.Length == 0)
            return;

        Undo.RecordObjects(selected, "Add Rigidbody");

        foreach (GameObject obj in selected)
        {
            if (obj.GetComponent<Rigidbody>() == null)
            {
                obj.AddComponent<Rigidbody>();
            }
        }

        Debug.Log($"å·²ä¸º {selected.Length} ä¸ªç‰©ä½“æ·»åŠ  Rigidbody");
    }

    // æ‰¹é‡è®¾ç½®å±‚
    [MenuItem("Tools/Batch/Set Layer")]
    static void BatchSetLayer()
    {
        int selectedLayer = EditorGUILayout.LayerField("ç›®æ ‡å±‚", 0);

        if (!EditorUtility.DisplayDialog("ç¡®è®¤",
            $"å°†æ‰€æœ‰é€‰ä¸­ç‰©ä½“è®¾ç½®åˆ°å±‚ {LayerMask.LayerToName(selectedLayer)}?",
            "ç¡®å®š", "å–æ¶ˆ"))
        {
            return;
        }

        GameObject[] selected = Selection.gameObjects;
        Undo.RecordObjects(selected, "Set Layer");

        foreach (GameObject obj in selected)
        {
            obj.layer = selectedLayer;
        }

        Debug.Log($"å·²å°† {selected.Length} ä¸ªç‰©ä½“è®¾ç½®åˆ°å±‚ {LayerMask.LayerToName(selectedLayer)}");
    }

    [MenuItem("Tools/Batch/Set Layer", true)]
    static bool ValidateBatchSetLayer()
    {
        return Selection.gameObjects.Length > 0;
    }
}
```

---

## ä¹ã€å¿«æ·é”®é€ŸæŸ¥è¡¨

| å¿«æ·é”®ä»£ç  | Windows | macOS | è¯´æ˜ |
|-----------|---------|-------|------|
| `%` | Ctrl | Cmd | Control |
| `#` | Shift | Shift | Shift |
| `&` | Alt | Alt | Alt |
| `_%g` | Ctrl+Shift+G | Cmd+Shift+G | ç»„åˆé”® |
| `#_g` | Shift+G | Shift+G | Shiftç»„åˆ |
| `F1` | F1 | F1 | åŠŸèƒ½é”® |
| `LEFT` | å·¦æ–¹å‘é”® | å·¦æ–¹å‘é”® | æ–¹å‘é”® |

### å¸¸ç”¨å¿«æ·é”®ç¤ºä¾‹

```csharp
[MenuItem("Tools/Save %s")]           // Ctrl+S
[MenuItem("Tools/Open %o")]           // Ctrl+O
[MenuItem("Tools/Save %#s")]          // Ctrl+Shift+S
[MenuItem("Tools/Undo %z")]           // Ctrl+Z
[MenuItem("Tools/Redo %#z")]          // Ctrl+Shift+Z
[MenuItem("Tools/Delete #d")]         // Shift+D
```

---

## åã€æ€»ç»“

æœ¬æ–‡ä»‹ç»äº† Unity MenuItem çš„å¼€å‘è¦ç‚¹ï¼š

| ä¸»é¢˜ | è¦ç‚¹ |
|------|------|
| **åŸºæœ¬ç”¨æ³•** | `[MenuItem("è·¯å¾„")]` é™æ€æ–¹æ³• |
| **ä¼˜å…ˆçº§** | `priority` å‚æ•°ï¼Œè¶Šå°è¶Šé å‰ |
| **éªŒè¯å‡½æ•°** | åŒå `bool` æ–¹æ³•æ§åˆ¶å¯ç”¨çŠ¶æ€ |
| **å‹¾é€‰çŠ¶æ€** | `Menu.GetChecked/SetChecked` |
| **å¿«æ·é”®** | è·¯å¾„åæ·»åŠ ç‰¹æ®Šå­—ç¬¦ |
| **ä¸Šä¸‹æ–‡èœå•** | `CONTEXT/...` è·¯å¾„ |
| **èµ„æºèœå•** | `Assets/...` è·¯å¾„ |
| **GameObjectèœå•** | `GameObject/...` è·¯å¾„ |

> ğŸ’¡ **å¼€å‘å»ºè®®**ï¼š
> - ä½¿ç”¨æœ‰æ„ä¹‰çš„èœå•è·¯å¾„ï¼Œä¾¿äºç»„ç»‡
> - ä¼˜å…ˆçº§ä½¿ç”¨ 10ã€100 ç­‰æ ‡å‡†é—´éš”
> - æ€»æ˜¯ä¸ºèœå•é¡¹æ·»åŠ éªŒè¯å‡½æ•°
> - å¿«æ·é”®é€‰æ‹©ä¸å¸¸ç”¨ç»„åˆï¼Œé¿å…å†²çª
> - æ‰¹é‡æ“ä½œä½¿ç”¨ Undo è®°å½•ï¼Œæ”¯æŒæ’¤é”€

---

**è½¬è½½è¯·æ³¨æ˜æ¥æº**ï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 1487842110@qq.com
